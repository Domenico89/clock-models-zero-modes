(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     97124,       2358]
NotebookOptionsPosition[     96519,       2338]
NotebookOutlinePosition[     96854,       2353]
CellTagsIndexPosition[     96811,       2350]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.697291024928825*^9, 3.6972910433770657`*^9}, 
   3.697291084003364*^9, {3.7511965482079887`*^9, 3.751196574342608*^9}, {
   3.7731183818468657`*^9, 
   3.77311838683674*^9}},ExpressionUUID->"fa4eb9e9-fb41-4cf7-90e5-\
0843f1db2012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "that", " ", "gives", " ", "back", " ", "the", " ", 
    "clock", " ", "values", " ", "of", " ", "the", " ", "basis", " ", 
    "elements"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vectorToClock", "[", 
     RowBox[{"number_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"IntegerDigits", "[", 
     RowBox[{
      RowBox[{"number", "-", "1"}], ",", "basis", ",", "L"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "gives", " ", "back", " ", "the", " ", 
     "basis", " ", "element", " ", "from", " ", "the", " ", "clock", " ", 
     "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clockToVector", "[", 
     RowBox[{"clock_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"clock", ",", "basis"}], "]"}], "+", "1"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "gives", " ", "back", " ", "the", " ", 
      "left"}], "-", 
     RowBox[{
     "right", " ", "clock", " ", "of", " ", "the", " ", "super", " ", 
      "operators", " ", "values", " ", "of", " ", "the", " ", "basis", " ", 
      "elements"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vectorToLeftRight", "[", 
     RowBox[{"number_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "vettore", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vettore", "=", 
        RowBox[{"vectorToClock", "[", 
         RowBox[{"number", ",", 
          RowBox[{"2", "L"}], ",", "basis"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"vettore", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"2", "k"}], "-", "1"}], "]"}], "]"}], ",", "basis"}],
              "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"vettore", "[", 
             RowBox[{"[", 
              RowBox[{"2", "k"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "gives", " ", "back", " ", "the", " ", 
      "basis", " ", "elements", " ", "of", " ", "the", " ", "left"}], "-", 
     RowBox[{"right", " ", "clock"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"leftRightToVector", "[", 
     RowBox[{"LeftRight_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "vettore", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vettore", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"LeftRight", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"Quotient", "[", 
               RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"LeftRight", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"Quotient", "[", 
               RowBox[{
                RowBox[{"k", "+", "1"}], ",", "2"}], "]"}], "]"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"2", "L"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"clockToVector", "[", 
         RowBox[{"vettore", ",", 
          RowBox[{"2", "L"}], ",", "basis"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "returns", " ", "the", " ", "positions", 
     " ", "and", " ", "the", " ", "values", " ", "of", " ", "a", " ", 
     "sparse", " ", "array"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nonzeroPosVal", "[", "vect_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", 
        RowBox[{"vect", "[", "\"\<NonzeroPositions\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"k", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "temp"}], "}"}]}], "]"}], ",", 
          RowBox[{"vect", "[", "\"\<NonzeroValues\>\"", "]"}]}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "given", " ", "positions", " ", "and", " ", 
     "values", " ", "makes", " ", "the", " ", "vector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"makeVector", "[", 
     RowBox[{"pos_", ",", "val_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
         RowBox[{"val", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"basis", "^", 
       RowBox[{"(", 
        RowBox[{"2", "L"}], ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "a", " ", "set", " ", "of", 
      " ", "basis", " ", "and", " ", "associated", " ", "values", " ", 
      "print", " ", "them", " ", "in", " ", "the", " ", "form", " ", "of", 
      " ", "Left"}], "-", 
     RowBox[{"Right", " ", "superoperators"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintLeftRight", "[", 
     RowBox[{"numbers_", ",", "values_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "length", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", "numbers", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"numbers", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "basis"}], "]"}],
            ",", "\"\< \>\"", ",", 
           RowBox[{"values", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "length"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "a", " ", "vector", " ", 
      "prints", " ", "its", " ", "basis", " ", "components", " ", "and", " ", 
      "related", " ", "values", " ", "in", " ", "the", " ", "form", " ", "of",
       " ", "Left"}], "-", 
     RowBox[{"Right", " ", "superoperators"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintLeftRightVector", "[", 
     RowBox[{"vect_", ",", "L_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "val"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "vect", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintLeftRight", "[", 
        RowBox[{"pos", ",", "val", ",", "L", ",", "basis"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "an", " ", "operator", " ", 
      "in", " ", "the", " ", "super"}], "-", 
     RowBox[{
     "operator", " ", "basis", " ", "construct", " ", "its", " ", "matrix", 
      " ", "form"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fromVectorToMatrix", "[", 
     RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "val"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"clockToVector", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vectorToLeftRight", "[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "L", ",", "3"}], "]"}],
                ",", 
               RowBox[{"clockToVector", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vectorToLeftRight", "[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "L", ",", "3"}], 
                "]"}]}], "}"}], "\[Rule]", 
             RowBox[{"val", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "^", "L"}], ",", 
            RowBox[{"3", "^", "L"}]}], "}"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "an", " ", "operator", " ", 
      "in", " ", "matrix", " ", "form", " ", "gives", " ", "it", " ", "back", 
      " ", "in", " ", "the", " ", "super"}], "-", 
     RowBox[{"operator", " ", "basis"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fromMatrixToVector", "[", 
     RowBox[{"M_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"postemp", ",", "pos", ",", "val"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"postemp", "=", 
        RowBox[{"M", "[", "\"\<NonzeroPositions\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"val", "=", 
        RowBox[{"M", "[", "\"\<NonzeroValues\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"leftRightToVector", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vectorToClock", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"postemp", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "L", ",", "3"}], "]"}], 
              ",", 
              RowBox[{"vectorToClock", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"postemp", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "L", ",", "3"}], 
               "]"}]}], "}"}], ",", "L"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "[", "postemp", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"pos", ",", "val", ",", "L", ",", "3"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.718798591381991*^9, 3.7187986038052187`*^9}, {
   3.7187986589331923`*^9, 3.7187986595864897`*^9}, {3.71904153426492*^9, 
   3.7190415366125927`*^9}, {3.74556650385073*^9, 3.745566506203392*^9}, {
   3.7726197363503017`*^9, 3.7726197586020823`*^9}, {3.772619830288422*^9, 
   3.772619866175894*^9}, {3.772619906683229*^9, 3.772619908691167*^9}, {
   3.7726206224914103`*^9, 3.772620625911228*^9}, {3.772620729631249*^9, 
   3.7726207677409153`*^9}, {3.772632709540969*^9, 3.772632861947125*^9}, {
   3.7726329684695177`*^9, 3.772633037444583*^9}, {3.77270276211005*^9, 
   3.772702800053681*^9}, {3.772882434185193*^9, 3.772882554559651*^9}, {
   3.773467798765951*^9, 3.77346779935343*^9}, {3.7734678528810387`*^9, 
   3.773467853889732*^9}, {3.773467915121519*^9, 3.7734679513495607`*^9}, 
   3.773468009150906*^9, 3.773468045355007*^9, {3.773468113500242*^9, 
   3.773468300877226*^9}},ExpressionUUID->"29441573-4bfe-4854-a80c-\
1f5024bd061c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"2", "I", "*", 
     RowBox[{"Pi", "/", "3"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7726136904955387`*^9},ExpressionUUID->"d8f266d0-6930-47e6-8b98-\
7dba72236d0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "that", " ", "given", " ", "positions", " ", "and", " ", 
     "values", " ", "returns", " ", "the", " ", "elements", " ", "whose", " ",
      "clocks", " ", "differ", " ", "at", " ", "position", " ", "L"}], "-", 
    "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindDiff", "[", 
     RowBox[{"pos_", ",", "val_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"posDiff", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"valDiff", "=", 
         RowBox[{"{", "}"}]}], ",", "tempLeftRight"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempLeftRight", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "1"}], "]"}], "]"}], "!=", 
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"posDiff", ",", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"valDiff", ",", 
               RowBox[{"val", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"posDiff", ",", "valDiff"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "a", " ", "vector", " ", 
      "returns", " ", "the", " ", "components", " ", "whose", " ", "clocks", 
      " ", "differ", " ", "at", " ", "position", " ", "L"}], "-", "1"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindDiffVector", "[", 
     RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"posDiff", ",", "valDiff", ",", "pos", ",", "val"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"posDiff", ",", "valDiff"}], "}"}], "=", 
        RowBox[{"FindDiff", "[", 
         RowBox[{"pos", ",", "val", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"posDiff", ",", "valDiff", ",", "L", ",", "3"}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "positions", " ", "and", " ",
       "values", " ", "returns", " ", "the", " ", "elements", " ", "whose", 
      " ", "clocks", " ", "are", " ", "the", " ", "same", " ", "at", " ", 
      "position", " ", "L"}], "-", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindSame", "[", 
     RowBox[{"pos_", ",", "val_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"posSame", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"valSame", "=", 
         RowBox[{"{", "}"}]}], ",", "tempLeftRight"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempLeftRight", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "1"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"posSame", ",", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"valSame", ",", 
               RowBox[{"val", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"posSame", ",", "valSame"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "a", " ", "vector", " ", 
      "returns", " ", "the", " ", "components", " ", "whose", " ", "clocks", 
      " ", "are", " ", "the", " ", "same", " ", "at", " ", "position", " ", 
      "L"}], "-", "1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindSameVector", "[", 
     RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"posSame", ",", "valSame", ",", "pos", ",", "val"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"posSame", ",", "valSame"}], "}"}], "=", 
        RowBox[{"FindSame", "[", 
         RowBox[{"pos", ",", "val", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"posSame", ",", "valSame", ",", "L", ",", "3"}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Make", " ", "the", " ", "identity", " ", "vector", " ", "of", " ", "a", 
     " ", "given", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zeroVector", "[", "L_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"result", ",", "zero"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zero", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
           ",", "0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"result", ",", "zero"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Given", " ", "positions", " ", "and", " ", "values", " ", "that", " ", 
     "are", " ", "known", " ", "to", " ", "come", " ", "from", " ", "vectors",
      " ", "that", " ", "have", " ", "an", " ", "identity", " ", "at", " ", 
     "the", " ", "end", " ", "returns", " ", "the", " ", "positions", " ", 
     "and", " ", "values", " ", "coming", " ", "from", " ", "a", " ", 
     "vector", " ", "with", " ", "the", " ", "identity", " ", "removed"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reducePosVal", "[", 
     RowBox[{"pos_", ",", "val_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"posReduced", ",", "valReduced", ",", "k", ",", "temp"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posReduced", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"valReduced", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "pos", "]"}]}], ",", 
         RowBox[{"k", "=", 
          RowBox[{"k", "+", "3"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"vectorToClock", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"2", "L"}], "+", "2"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"posReduced", ",", 
            RowBox[{"clockToVector", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"2", "L"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"2", "L"}], ",", "3"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"valReduced", ",", 
            RowBox[{"val", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"posReduced", ",", "valReduced"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Given", " ", "vector", " ", "that", " ", "has", " ", "an", " ", 
     "identity", " ", "at", " ", "the", " ", "end", " ", "returns", " ", 
     "the", " ", "vector", " ", "with", " ", "the", " ", "identity", " ", 
     "removed"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reduceVector", "[", 
     RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "val", ",", "postemp", ",", "valtemp"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"postemp", ",", "valtemp"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"reducePosVal", "[", 
         RowBox[{"postemp", ",", "valtemp", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"pos", ",", "val", ",", "L", ",", "3"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Construction", " ", "of", " ", "the", " ", "super"}], "-", 
     RowBox[{
     "operator", " ", "corresponding", " ", "to", " ", "the", " ", 
      "commutator", " ", "with", " ", "H0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"L_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Sigma]", ",", "\[Tau]", ",", "h", ",", "i", ",", "block1", ",", 
        "block2", ",", "temp", ",", "id1", ",", "id2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Sigma]", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "1"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
            RowBox[{"Exp", "[", 
             RowBox[{"2", "Pi", "*", 
              RowBox[{"I", "/", "3"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], "Pi", "*", 
              RowBox[{"I", "/", "3"}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"block1", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]", ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"3", ",", "SparseArray"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"block1", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "block1", "]"}], ",", "block1"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"block2", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"3", ",", "SparseArray"}], "]"}], ",", "\[Sigma]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"block2", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "block2", "]"}], ",", "block2"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}], ",", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"id1", "=", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"3", "^", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], ")"}]}], ",", 
             "SparseArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"id2", "=", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"3", "^", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"L", "-", "i", "-", "1"}], ")"}]}], ")"}]}], ",", 
             "SparseArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id1", ",", "block1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"temp", ",", "id2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"h", "-", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "\[Theta]"}], "]"}], "temp"}], "-", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], "*", "\[Theta]"}], "]"}], 
             RowBox[{"ConjugateTranspose", "[", "temp", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id1", ",", "block2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"temp", ",", "id2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"h", "=", 
           RowBox[{"h", "+", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "\[Theta]"}], "]"}], "temp"}], "+", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], "*", "\[Theta]"}], "]"}], 
             RowBox[{"ConjugateTranspose", "[", "temp", "]"}]}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"Simplify", "[", "h", "]"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Construction", " ", "of", " ", "the", " ", "super"}], "-", 
     RowBox[{
     "operator", " ", "corresponding", " ", "to", " ", "the", " ", 
      "commutator", " ", "with", " ", "V"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"V", "[", 
     RowBox[{"L_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Tau]", ",", "v", ",", "i", ",", "block1", ",", "block2", ",", 
        "temp", ",", "id1", ",", "id2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Tau]", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"block1", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Tau]", ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"3", ",", "SparseArray"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"block2", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"3", ",", "SparseArray"}], "]"}], ",", "\[Tau]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}], ",", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"id1", "=", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"3", "^", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], ")"}]}], ",", 
             "SparseArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"id2", "=", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"3", "^", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"L", "-", "i"}], ")"}]}], ")"}]}], ",", 
             "SparseArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id1", ",", "block1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"temp", ",", "id2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"v", "-", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "\[Phi]"}], "]"}], "temp"}], "-", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], "*", "\[Phi]"}], "]"}], 
             RowBox[{"ConjugateTranspose", "[", "temp", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id1", ",", "block2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"temp", ",", "id2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"v", "+", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], "*", "\[Phi]"}], "]"}], "temp"}], "+", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "\[Phi]"}], "]"}], 
             RowBox[{"ConjugateTranspose", "[", "temp", "]"}]}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Simplify", "[", "v", "]"}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "return", " ", "the", " ", "projector", " ",
      "into", " ", "Null", 
     RowBox[{
      RowBox[{"(", "H0", ")"}], ".", " ", "Hmatrix"}], " ", "is", " ", "a", 
     " ", "vector", " ", "containing", " ", "the", " ", "diagonal", " ", "of",
      " ", "Hmatrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P0", "[", 
     RowBox[{"L_", ",", "Hmatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "P0temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P0temp", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"3", "^", 
               RowBox[{"(", 
                RowBox[{"2", "L"}], ")"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Hmatrix", "[", "\"\<NonzeroPositions\>\"", "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"P0temp", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "P0temp", "]"}]}], "}"}]}], "]"}], ",", 
          "L", ",", "3"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Function", " ", "that", " ", "return", " ", 
      RowBox[{"Q0", "/", "H0"}], " ", "with", " ", "Q0"}], "=", 
     RowBox[{"1", "-", "P0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q0H0", "[", 
     RowBox[{"L_", ",", "Hmatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "val"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "Hmatrix", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"makeVector", "[", 
         RowBox[{"pos", ",", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"1", "/", "val"}], "]"}], ",", "L", ",", "3"}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Function", " ", "that", " ", "builds", " ", 
      SubscriptBox["\[Chi]", "q"], " ", "and", " ", 
      SubscriptBox["P0V\[Chi]", "q"]}], ",", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "latter", " ", "is", " ", "found", " ", "assuming", " ", 
       "to", " ", "be", " ", "at", " ", "a", " ", "\[Theta]", " ", "that", 
       " ", "conserves", " ", "total", " ", "domain", " ", "wall", " ", 
       RowBox[{"parity", ".", " ", "As"}], " ", "input", " ", "H0matrix", " ",
        "has", " ", "to", " ", "be", " ", "acting", " ", "on", " ", "chains", 
       " ", "of", " ", "lenght", " ", "L"}], "+", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"only", " ", "the", " ", "main", " ", "diagonal"}], ")"}], 
       " ", "and", " ", "V", " ", "acts", " ", "on", " ", "chains", " ", "of",
        " ", "length", " ", "L"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Find\[Chi]q", "[", 
     RowBox[{
     "vin_", ",", "H0matrix_", ",", "P0temp_", ",", "Q0H0temp_", ",", 
      "Vmatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "zero", ",", "L", ",", "temp", ",", "tempLeftRight", ",", "\[Chi]q", 
        ",", "problem", ",", "pos", ",", "val"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zero", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
           ",", "0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L", "=", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"3", ",", 
           RowBox[{"Length", "[", "vin", "]"}]}], "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"FullSimplify", "[", 
              RowBox[{"Vmatrix", ".", "vin"}], "]"}], "}"}], ",", "zero"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]q", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"-", "Q0H0temp"}], "*", "temp"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[Chi]q", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Function", " ", "that"}], ",", " ", 
     RowBox[{
      RowBox[{
      "given", " ", "vectors", " ", "that", " ", "differs", " ", "at", " ", 
       "the", " ", "clock", " ", "at", " ", "position", " ", "L"}], "-", 
      "1"}], ",", " ", 
     RowBox[{
      RowBox[{
      "finds", " ", "the", " ", "solution", " ", "of", " ", "the", " ", 
       RowBox[{"problem", ".", " ", "This"}], " ", "function", " ", "works", 
       " ", "when", " ", "\[Theta]"}], "=", 
      RowBox[{
       RowBox[{"Pi", "/", "6"}], " ", "or", " ", "is", " ", "not", " ", "at", 
       " ", "a", " ", "resonance", " ", 
       RowBox[{"point", ".", " ", "As"}], " ", "input", " ", "the", " ", 
       "matrix", " ", "H0", " ", "has", " ", "to", " ", "act", " ", "on", " ",
        "chains", " ", "of", " ", "lenght", " ", "L"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindSolutionDiff", "[", 
     RowBox[{
     "posDiff_", ",", "valDiff_", ",", "matrixH0_", ",", "L_", ",", 
      "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "temp", ",", "temp1", ",", "temp01", ",", "temp20", ",", "tempL", ",", 
        "tempR", ",", "solPos", ",", "solVal", ",", "basisDiff1", ",", 
        "valDiff1", ",", "position01", ",", "position20", ",", "val01", ",", 
        "val20", ",", 
        RowBox[{"control", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"solPos", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solVal", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"basisDiff1", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"valDiff1", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"posDiff", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Distinguish", " ", "between", " ", "left", " ", "and", " ", 
             "right", " ", "clocks", " ", "that", " ", "differ", " ", "and", 
             " ", "are", " ", "the", " ", "same", " ", "at", " ", "position", 
             " ", "L"}], "-", "2"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "2"}], "]"}], "]"}], "!=", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "-", "2"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tempL", "=", 
              RowBox[{"leftRightToVector", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"L", "-", "1"}], ",", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tempR", "=", 
              RowBox[{"leftRightToVector", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"L", "-", "1"}], ",", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "When", " ", "they", " ", "are", " ", "different", " ", "we", 
               " ", "can", " ", "find", " ", "the", " ", "solution", " ", 
               "by", " ", "making", " ", "the", " ", "last", " ", "element", 
               " ", "the", " ", "same"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"matrixH0", "[", 
                  RowBox[{"[", "tempL", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
                RowBox[{
                 RowBox[{"matrixH0", "[", 
                  RowBox[{"[", "tempR", "]"}], "]"}], "!=", 
                 RowBox[{"0", 
                  RowBox[{"Position", "[", 
                   RowBox[{"control", ",", "tempL"}], "]"}]}], "\[Equal]", 
                 RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solPos", ",", "tempL"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solVal", ",", 
                  RowBox[{
                   RowBox[{"+", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}]}], ",", "3"}], 
                    "]"}], ")"}]}], "I", "*", "\[Phi]"}], "]"}]}], 
                   RowBox[{"valDiff", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"control", ",", "tempL"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"matrixH0", "[", 
                  RowBox[{"[", "tempR", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
                RowBox[{
                 RowBox[{"matrixH0", "[", 
                  RowBox[{"[", "tempL", "]"}], "]"}], "!=", "0"}], "&&", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"control", ",", "tempR"}], "]"}], "\[Equal]", 
                 RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solPos", ",", "tempR"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solVal", ",", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"L", "-", "1"}], "]"}], "]"}]}], ",", "3"}], 
                    "]"}], ")"}]}], "I", "*", "\[Phi]"}], "]"}]}], 
                   RowBox[{"valDiff", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"control", ",", "tempR"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"basisDiff1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"temp", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"temp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"valDiff1", ",", 
               RowBox[{"valDiff", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "posDiff", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"control", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "When", " ", "they", " ", "are", " ", "the", " ", "same", " ", "to",
            " ", "get", " ", "the", " ", "solution", " ", "we", " ", "need", 
           " ", "to", " ", "solve", " ", "a", " ", "system", " ", "of", " ", 
           "linear", " ", "equations"}], ",", " ", 
          RowBox[{
          "and", " ", "the", " ", "solution", " ", "depends", " ", "on", " ", 
           "the", " ", "values", " ", "coming", " ", "from", " ", "the", " ", 
           "elements", " ", "with", " ", "0", " ", "on", " ", "the", " ", 
           "left", " ", "and", " ", "1", " ", "on", " ", "the", " ", "right", 
           " ", "or", " ", "with", " ", "2", " ", "on", " ", "the", " ", 
           "left", " ", "and", " ", "0", " ", "on", " ", "the", " ", 
           "right"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"basisDiff1", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp01", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "0"}], "]"}], 
             ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "1"}], 
              "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp20", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "0"}], 
              "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temp1", "=", 
           RowBox[{"leftRightToVector", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"temp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", 
                  RowBox[{"L", "-", "2"}]}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"L", "-", "2"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"control", ",", "temp1"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"position01", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"basisDiff1", ",", "temp01"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"position01", "\[NotEqual]", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"val01", "=", 
                RowBox[{"valDiff1", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"position01", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"val01", "=", "0"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"position20", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"basisDiff1", ",", "temp20"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"position20", "\[NotEqual]", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"val20", "=", 
                RowBox[{"valDiff1", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"position20", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"val20", "=", "0"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solPos", ",", 
               RowBox[{"leftRightToVector", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "0"}], 
                    "]"}], ",", 
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "0"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"L", "-", "1"}], ",", "3"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solVal", ",", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "3"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], "*", "\[Phi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"val01", "-", "val20"}], ")"}]}], "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solPos", ",", 
               RowBox[{"leftRightToVector", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}], ",", 
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "1"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"L", "-", "1"}], ",", "3"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solVal", ",", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "3"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], "*", "\[Phi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], "val01"}], "-", "val20"}], ")"}]}], 
                "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solPos", ",", 
               RowBox[{"leftRightToVector", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "2"}], 
                    "]"}], ",", 
                   RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"L", "-", "2"}]}], "]"}], "]"}], ",", "2"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"L", "-", "1"}], ",", "3"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"solVal", ",", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "3"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], "*", "\[Phi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"val01", "+", 
                   RowBox[{"2", "val20"}]}], ")"}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"control", ",", "temp1"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "basisDiff1", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"solPos", ",", "solVal"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", " ", "that", " ", "given", " ", 
       SubscriptBox["P", "0"], 
       SuperscriptBox[
        SubscriptBox["V\[Chi]", "q"], 
        RowBox[{"(", "k", ")"}]], " ", "finds", " ", "a", " ", "solution", 
       " ", "to", " ", "the", " ", "problem", " ", 
       SubscriptBox["P", "0"], 
       SuperscriptBox[
        SubscriptBox["V\[Chi]", "p"], 
        RowBox[{"(", "k", ")"}]]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["P", "0"]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["V\[Chi]", "q"], 
          RowBox[{"(", "k", ")"}]], ".", " ", "As"}], " ", "inputs", " ", 
        "it", " ", "needs", " ", "problem"}], "=", 
       RowBox[{
        SubscriptBox["P", "0"], 
        SuperscriptBox[
         SubscriptBox["V\[Chi]", "q"], 
         RowBox[{"(", "k", ")"}]]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "a", " ", "table", " ", "containing", " ", "H0", " ", "matrices", " ", 
       "acting", " ", "on", " ", "chains", " ", "of", " ", "lengths", " ", 
       "l", " ", 
       RowBox[{"s", ".", "t", ".", " ", "2"}]}], "<=", "l", "\[LessEqual]", 
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{"only", " ", "the", " ", "main", " ", "diagonal"}], ")"}]}]}],
      ",", " ", 
     RowBox[{
      RowBox[{
      "a", " ", "table", " ", "containing", " ", "V", " ", "matrices", " ", 
       "acting", " ", "on", " ", "chains", " ", "of", " ", "lengths", " ", 
       "l", " ", 
       RowBox[{"s", ".", "t", ".", " ", "1"}]}], "\[LessEqual]", "l", 
      "\[LessEqual]", 
      RowBox[{"L", " ", "and", " ", "\[Phi]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Find\[Chi]p", "[", 
     RowBox[{
     "problem_", ",", "H0matrices_", ",", "Vmatrices_", ",", "\[Phi]_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L", ",", "matrixV", ",", "matrixH0", ",", 
        RowBox[{"\[Chi]p", "=", 
         RowBox[{"{", "}"}]}], ",", "\[Chi]ptemp", ",", "P0temp", ",", 
        "tempLeftRight", ",", "problemtemp", ",", "pos", ",", "val", ",", 
        "problemDiffPos", ",", "problemDiffVal", ",", "solPos", ",", "solVal",
         ",", "\[Chi]psum"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "=", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"3", ",", 
           RowBox[{"Length", "[", "problem", "]"}]}], "]"}], "/", "2"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"problem", "==", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"2", "L"}], ")"}]}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"problemtemp", "=", "problem"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Finds", " ", "a", " ", "solution", " ", "using", " ", "the", " ", 
            "alghorithm", " ", "described", " ", "in", " ", "the", " ", 
            "thesis", " ", "and", " ", "using", " ", "FindSolutionDiff"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"matrixV", "=", 
              RowBox[{"Vmatrices", "[", 
               RowBox[{"[", 
                RowBox[{"l", "-", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"matrixH0", "=", 
              RowBox[{"H0matrices", "[", 
               RowBox[{"[", 
                RowBox[{"l", "-", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"P0temp", "=", 
              RowBox[{"P0", "[", 
               RowBox[{"l", ",", "matrixH0"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pos", ",", "val"}], "}"}], "=", 
              RowBox[{"nonzeroPosVal", "[", "problemtemp", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"problemtemp", "=", 
              RowBox[{"SparseArray", "[", 
               RowBox[{"FullSimplify", "[", "problemtemp", "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pos", ",", "val"}], "}"}], "=", 
              RowBox[{"nonzeroPosVal", "[", "problemtemp", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"problemDiffPos", ",", "problemDiffVal"}], "}"}], "=", 
              
              RowBox[{"FindDiff", "[", 
               RowBox[{"pos", ",", "val", ",", "l"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"solPos", ",", "solVal"}], "}"}], "=", 
              RowBox[{"FindSolutionDiff", "[", 
               RowBox[{
               "problemDiffPos", ",", "problemDiffVal", ",", "matrixH0", ",", 
                "l", ",", "\[Phi]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"\[Chi]p", ",", 
               RowBox[{"makeVector", "[", 
                RowBox[{"solPos", ",", "solVal", ",", 
                 RowBox[{"l", "-", "1"}], ",", "3"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"problemtemp", "=", 
              RowBox[{"problemtemp", "+", 
               RowBox[{"P0temp", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"KroneckerProduct", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"matrixV", ".", 
                    RowBox[{"\[Chi]p", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"zeroVector", "[", "1", "]"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"problemtemp", "=", 
              RowBox[{"reduceVector", "[", 
               RowBox[{
                RowBox[{"SparseArray", "[", 
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{"FindSameVector", "[", 
                   RowBox[{"problemtemp", ",", "l"}], "]"}], "]"}], "]"}], 
                ",", 
                RowBox[{"l", "-", "1"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "L", ",", "3", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Chi]psum", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Chi]p", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "}"}], ",", 
                RowBox[{"zeroVector", "[", "k", "]"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "\[Chi]p", "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "\[Chi]psum", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Given", " ", "a", " ", "vector", " ", "returns", " ", "only", " ", "the",
      " ", "components", " ", "whose", " ", "left", " ", "clocks", " ", 
     "start", " ", "with", " ", "0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GivenAllReturn0", "[", 
     RowBox[{"\[Chi]_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "val", ",", "result", ",", "tempLeftRight"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "\[Chi]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"3", "^", 
           RowBox[{"(", 
            RowBox[{"2", "L"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempLeftRight", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "[", 
              RowBox[{"[", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"val", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Given", " ", "a", " ", "vector", " ", "whose", " ", "components", " ", 
     "have", " ", "left", " ", "clocks", " ", "thet", " ", "start", " ", 
     "with", " ", "0", " ", "reconstruct", " ", "the", " ", "whole", " ", 
     "vector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Given0ReturnAll", "[", 
     RowBox[{"\[Chi]0_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pos", ",", "val", ",", "\[Chi]tot", ",", "tempLeftRight", ",", "pos0",
         ",", "pos1", ",", "pos2", ",", "Add"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "\[Chi]0", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]tot", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"3", "^", 
           RowBox[{"(", 
            RowBox[{"2", "L"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Add", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempLeftRight", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "L", ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"pos0", "=", 
           RowBox[{"pos", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pos1", "=", 
           RowBox[{"leftRightToVector", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"tempLeftRight", "+", "Add"}], ",", "3"}], "]"}], ",", 
             "L", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pos2", "=", 
           RowBox[{"leftRightToVector", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"tempLeftRight", "+", 
                RowBox[{"2", "Add"}]}], ",", "3"}], "]"}], ",", "L", ",", 
             "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Chi]tot", "[", 
            RowBox[{"[", "pos0", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Chi]tot", "[", 
             RowBox[{"[", "pos0", "]"}], "]"}], "+", 
            RowBox[{"val", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Chi]tot", "[", 
            RowBox[{"[", "pos1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Chi]tot", "[", 
             RowBox[{"[", "pos1", "]"}], "]"}], "+", 
            RowBox[{"\[Omega]", "*", 
             RowBox[{"val", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Chi]tot", "[", 
            RowBox[{"[", "pos2", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Chi]tot", "[", 
             RowBox[{"[", "pos2", "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"\[Omega]", "^", "2"}], "*", 
             RowBox[{"val", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[Chi]tot", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "given", " ", "a", " ", "solution", " ", 
      "at", " ", "a", " ", "given", " ", "order", " ", "finds", " ", "the", 
      " ", "next", " ", 
      RowBox[{"one", ".", "  ", "As"}], " ", "inputs", " ", "it", " ", 
      "needs", " ", "the", " ", "known", " ", "solution", " ", "\[Psi]"}], 
     ",", " ", 
     RowBox[{
      RowBox[{
      "a", " ", "table", " ", "containing", " ", "H0", " ", "matrices", " ", 
       "acting", " ", "on", " ", "chains", " ", "of", " ", "lengths", " ", 
       "l", " ", 
       RowBox[{"s", ".", "t", ".", " ", "2"}]}], "<=", "l", "\[LessEqual]", 
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{"only", " ", "the", " ", "main", " ", "diagonal"}], ")"}]}]}],
      ",", " ", 
     RowBox[{
      RowBox[{
      "a", " ", "table", " ", "containing", " ", "V", " ", "matrices", " ", 
       "acting", " ", "on", " ", "chains", " ", "of", " ", "lengths", " ", 
       "l", " ", 
       RowBox[{"s", ".", "t", ".", " ", "1"}]}], "\[LessEqual]", "l", 
      "\[LessEqual]", 
      RowBox[{"L", " ", "and", " ", "\[Phi]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindSolution", "[", 
     RowBox[{
     "\[Psi]_", ",", "H0matrices_", ",", "Vmatrices_", ",", "\[Phi]_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pos", ",", "val", ",", "temp", ",", "tempLeftRight", ",", "L", ",", 
        "Vmatrix", ",", "H0matrix", ",", "P0temp", ",", "\[Psi]0", ",", 
        "\[Chi]q0", ",", "\[Chi]q", ",", "Q0H0temp", ",", "problem", ",", 
        "problem0", ",", "\[Chi]p0", ",", "\[Chi]p"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "=", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"3", ",", 
           RowBox[{"Length", "[", "\[Psi]", "]"}]}], "]"}], "/", "2"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"H0matrix", "=", 
        RowBox[{"H0matrices", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P0temp", "=", 
        RowBox[{"P0", "[", 
         RowBox[{
          RowBox[{"L", "+", "1"}], ",", "H0matrix"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Q0H0temp", "=", 
        RowBox[{"Q0H0", "[", 
         RowBox[{
          RowBox[{"L", "+", "1"}], ",", "H0matrix"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Psi]0", "=", 
        RowBox[{"GivenAllReturn0", "[", 
         RowBox[{"\[Psi]", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]q0", "=", 
        RowBox[{"Find\[Chi]q", "[", 
         RowBox[{
         "\[Psi]0", ",", "H0matrix", ",", "P0temp", ",", "Q0H0temp", ",", 
          RowBox[{"Vmatrices", "[", 
           RowBox[{"[", 
            RowBox[{"-", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]q", "=", 
        RowBox[{"Given0ReturnAll", "[", 
         RowBox[{"\[Chi]q0", ",", 
          RowBox[{"L", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vmatrix", "=", 
        RowBox[{"Vmatrices", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"problem", "=", 
        RowBox[{"P0temp", "*", 
         RowBox[{"(", 
          RowBox[{"Vmatrix", ".", "\[Chi]q"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "val"}], "}"}], "=", 
        RowBox[{"nonzeroPosVal", "[", "problem", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tempLeftRight", "=", 
           RowBox[{"vectorToLeftRight", "[", 
            RowBox[{"k", ",", 
             RowBox[{"L", "+", "1"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "+", "1"}], "]"}], "]"}], "\[NotEqual]", 
             RowBox[{
              RowBox[{"tempLeftRight", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"L", "+", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"problem", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "=", "0"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "pos"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"problem", "=", 
        RowBox[{"SparseArray", "[", "problem", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"problem0", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"GivenAllReturn0", "[", 
           RowBox[{"problem", ",", 
            RowBox[{"L", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]p0", "=", 
        RowBox[{"Find\[Chi]p", "[", 
         RowBox[{
         "problem0", ",", "H0matrices", ",", "Vmatrices", ",", "\[Phi]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]p", "=", 
        RowBox[{"Given0ReturnAll", "[", 
         RowBox[{"\[Chi]p0", ",", 
          RowBox[{"L", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"\[Chi]p", ",", "\[Chi]q"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "given", " ", "the", " ", "various", " ", 
     "solutions", " ", "up", " ", "to", " ", "order", " ", "k", " ", "as", 
     " ", "given", " ", "by", " ", "FindSolution", " ", "returns", " ", "the",
      " ", "order", " ", "k", " ", "of", " ", "the", " ", "square", " ", "of",
      " ", "the", " ", "zero", " ", "mode", " ", "in", " ", "matrix", " ", 
     "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"squareOrderk", "[", "\[Psi]_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "\[Psi]m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"Length", "[", "\[Psi]", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Psi]m", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"fromVectorToMatrix", "[", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"3", "^", 
               RowBox[{"(", 
                RowBox[{"k", "-", "j"}], ")"}]}], ",", "SparseArray"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", 
               RowBox[{"k", "-", "j", "+", "1"}], "]"}], "]"}], ".", 
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}], "]"}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "given", " ", "the", " ", "various", " ", 
     "solutions", " ", "up", " ", "to", " ", "order", " ", "k", " ", "as", 
     " ", "given", " ", "by", " ", "FindSolution", " ", "returns", " ", "the",
      " ", "order", " ", "k", " ", "of", " ", "the", " ", "cube", " ", "of", 
     " ", "the", " ", "zero", " ", "mode", " ", "in", " ", "matrix", " ", 
     "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cubeOrderk", "[", "\[Psi]_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k", ",", "\[Psi]m", ",", "partitions", ",", "partitionsWith0s", ",", 
        "allPossibilities"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"Length", "[", "\[Psi]", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Psi]m", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"fromVectorToMatrix", "[", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"3", "^", 
               RowBox[{"(", 
                RowBox[{"k", "-", "j"}], ")"}]}], ",", "SparseArray"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"partitions", "=", 
          RowBox[{"IntegerPartitions", "[", 
           RowBox[{
            RowBox[{"k", "-", "1"}], ",", 
            RowBox[{"k", "-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"partitions", "=", 
          RowBox[{"IntegerPartitions", "[", 
           RowBox[{
            RowBox[{"k", "-", "1"}], ",", "3"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"partitionsWith0s", "=", 
        RowBox[{"temp", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"3", "-", 
                  RowBox[{"Length", "[", "j", "]"}]}]}], "}"}]}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "partitions"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allPossibilities", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"allPossibilities", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"allPossibilities", ",", 
            RowBox[{"Permutations", "[", "j", "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "partitionsWith0s"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], "]"}], "]"}], 
             ".", 
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], "]"}], "]"}], 
             ".", 
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "allPossibilities"}], "}"}]}], "]"}], "]"}], 
         "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "given", " ", "the", " ", "various", " ", 
     "solutions", " ", "up", " ", "to", " ", "order", " ", "k", " ", "as", 
     " ", "given", " ", "by", " ", "FindSolution", " ", "returns", " ", "the",
      " ", "order", " ", "k", " ", "of", " ", 
     SuperscriptBox["\[Psi]", "\[Dagger]"], "\[Psi]", " ", "of", " ", "the", 
     " ", "zero", " ", "mode", " ", "in", " ", "matrix", " ", "form"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PsiDaggerPsiOrderk", "[", "\[Psi]_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "\[Psi]m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"Length", "[", "\[Psi]", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Psi]m", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"fromVectorToMatrix", "[", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "j"}], "]"}], ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"3", "^", 
               RowBox[{"(", 
                RowBox[{"k", "-", "j"}], ")"}]}], ",", "SparseArray"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"\[Psi]m", "[", 
               RowBox[{"[", 
                RowBox[{"k", "-", "j", "+", "1"}], "]"}], "]"}], "]"}], ".", 
             RowBox[{"\[Psi]m", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}], "]"}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.696326872838427*^9, 3.696326877259832*^9}, {
   3.6963269133810263`*^9, 3.696326943960198*^9}, {3.696326997403482*^9, 
   3.696327295765728*^9}, {3.6963274413269987`*^9, 3.696327469947674*^9}, {
   3.696327535661574*^9, 3.69632760693979*^9}, 3.6963276849336348`*^9, {
   3.696327733375104*^9, 3.6963278935086403`*^9}, {3.696327929498905*^9, 
   3.696327954955084*^9}, {3.6963279883180037`*^9, 3.696328008373255*^9}, {
   3.696328050025155*^9, 3.696328069350914*^9}, {3.696328152585824*^9, 
   3.696328176579159*^9}, {3.6963282113814583`*^9, 3.696328256535523*^9}, {
   3.6963283047429028`*^9, 3.696328330298205*^9}, {3.696328362443486*^9, 
   3.696328371773005*^9}, {3.696329125873699*^9, 3.696329145260099*^9}, {
   3.69632918842369*^9, 3.696329291247448*^9}, {3.696329411535061*^9, 
   3.696329470761126*^9}, {3.6963295541885967`*^9, 3.696329576131008*^9}, {
   3.6963296267614098`*^9, 3.6963296486588383`*^9}, {3.6963297002386627`*^9, 
   3.6963297262973633`*^9}, {3.696329798678255*^9, 3.696329799036756*^9}, {
   3.6963298305519247`*^9, 3.696329831146859*^9}, {3.696329873230394*^9, 
   3.696329899057869*^9}, {3.696329939820725*^9, 3.696329941257131*^9}, {
   3.696329992831668*^9, 3.696330001042323*^9}, {3.696330152593111*^9, 
   3.6963301529076757`*^9}, {3.696330370325645*^9, 3.696330616164103*^9}, {
   3.696331435110036*^9, 3.6963314385299177`*^9}, {3.696331640355557*^9, 
   3.696331783641206*^9}, {3.6963318867746572`*^9, 3.6963318958209047`*^9}, {
   3.696331940345991*^9, 3.6963320259473343`*^9}, {3.696332072006185*^9, 
   3.696332119703541*^9}, {3.69633215408597*^9, 3.696332308489802*^9}, {
   3.696332344073887*^9, 3.696332363031028*^9}, {3.696332474772685*^9, 
   3.6963325572542763`*^9}, {3.696332710293192*^9, 3.696332720625126*^9}, {
   3.696835285462755*^9, 3.696835330876234*^9}, {3.6968353919783792`*^9, 
   3.696835412611349*^9}, {3.696835486383231*^9, 3.6968355038238583`*^9}, {
   3.6968356682869263`*^9, 3.696835677342929*^9}, {3.696835793246408*^9, 
   3.696835804154779*^9}, {3.6970390587825403`*^9, 3.697039068323864*^9}, {
   3.7027159193400383`*^9, 3.702715964585287*^9}, {3.702716024136984*^9, 
   3.702716025549511*^9}, {3.702716192426861*^9, 3.7027162996931458`*^9}, {
   3.702716400356556*^9, 3.702716413116994*^9}, {3.702716483885985*^9, 
   3.702716488703188*^9}, {3.702722945345001*^9, 3.7027229664150476`*^9}, {
   3.702733527775673*^9, 3.702733543311758*^9}, {3.7028732582540493`*^9, 
   3.702873259103725*^9}, {3.703309055672853*^9, 3.7033090563941717`*^9}, 
   3.7365098351220417`*^9, {3.7389962192937527`*^9, 3.738996243664981*^9}, 
   3.738996332558853*^9, {3.7389966126930037`*^9, 3.738996625931498*^9}, {
   3.738997686199004*^9, 3.738997691489649*^9}, {3.738997969707808*^9, 
   3.73899797351831*^9}, {3.745563459119062*^9, 3.745563461114317*^9}, {
   3.745563493992855*^9, 3.74556351860293*^9}, {3.747395401534277*^9, 
   3.747395446298814*^9}, {3.7473954831259212`*^9, 3.747395562032926*^9}, {
   3.748071513445717*^9, 3.7480715199080973`*^9}, {3.753654399919051*^9, 
   3.753654429174499*^9}, {3.772633337917292*^9, 3.772633427615099*^9}, {
   3.772633552896448*^9, 3.772633562836026*^9}, {3.772633700413147*^9, 
   3.772633714991346*^9}, {3.772633751477562*^9, 3.772633759390942*^9}, {
   3.772633872771975*^9, 3.7726339693554907`*^9}, {3.772634022814658*^9, 
   3.772634136155281*^9}, {3.7726344083229923`*^9, 3.772634415931942*^9}, {
   3.7726999849694853`*^9, 3.7727000012113523`*^9}, {3.773467482997109*^9, 
   3.7734675521351433`*^9}, {3.773467874125723*^9, 3.7734678759394007`*^9}, {
   3.773468013879002*^9, 3.773468040749634*^9}, {3.773468806893626*^9, 
   3.773468890863014*^9}, {3.773468999224841*^9, 3.7734690099730463`*^9}, {
   3.773469053881847*^9, 3.7734691660794086`*^9}, {3.77346953044838*^9, 
   3.773469871670977*^9}, {3.773470120160233*^9, 3.7734701275145807`*^9}, {
   3.7734701737268667`*^9, 3.773470204962778*^9}, {3.7734702537487164`*^9, 
   3.7734703587521267`*^9}, {3.773470593572194*^9, 3.77347068308244*^9}, {
   3.7734707176649113`*^9, 3.77347075225808*^9}, {3.7734786151312847`*^9, 
   3.773478632578085*^9}, {3.7734793217860107`*^9, 3.7734793282361727`*^9}, {
   3.7734793644371634`*^9, 3.7734793650186872`*^9}, {3.773559305610529*^9, 
   3.7735593733914833`*^9}, {3.773559430353849*^9, 
   3.773559451067939*^9}},ExpressionUUID->"cfea54b3-7df9-44c0-8693-\
fbdcfd47ff1c"]
},
WindowSize->{1041, 621},
WindowMargins->{{0, Automatic}, {23, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 352, 7, 32, "Input", "ExpressionUUID" -> \
"fa4eb9e9-fb41-4cf7-90e5-0843f1db2012"],
Cell[913, 29, 13754, 343, 1186, "Input", "ExpressionUUID" -> \
"29441573-4bfe-4854-a80c-1f5024bd061c"],
Cell[14670, 374, 266, 8, 34, "Input", "ExpressionUUID" -> \
"d8f266d0-6930-47e6-8b98-7dba72236d0d"],
Cell[14939, 384, 81576, 1952, 6609, "Input", "ExpressionUUID" -> \
"cfea54b3-7df9-44c0-8693-fbdcfd47ff1c"]
}
]
*)

